import tkinter as tk
import random

# Accessory and Gacha Classes
class Accessory:
    def __init__(self, name, rarity, probability):
        self.name = name
        self.rarity = rarity
        self.probability = probability

    def __repr__(self):
        return f"{self.name} [{self.rarity}]"

class SpecialEgg:
    def __init__(self, accessories):
        self.accessories = accessories
        self.__normalize_probabilities__()

    def __normalize_probabilities__(self):
        total = sum(item.probability for item in self.accessories)
        for item in self.accessories:
            item.probability /= total

    def open(self):
        return random.choices(
            self.accessories,
            weights=[item.probability for item in self.accessories],
            k=1
        )[0]

# Gacha Items
default_accessories = [
    Accessory("ğŸ© Hat", "Common", 0.5),
    Accessory("ğŸ§¢ Snapback Cap", "Rare", 0.25),
    Accessory("ğŸ© Cinnabon Roll Clip", "Epic", 0.15),
    Accessory("ğŸ§¶ Cheekskawa Beanie", "Legendary", 0.10),
]

egg = SpecialEgg(default_accessories)
gacha_tickets = 3
inventory = []

# GUI Setup
root = tk.Tk()
root.title("Green App - Gacha Shop")
root.geometry("400x300")

result_label = tk.Label(root, text="ğŸ Gacha Result Will Appear Here", font=("Arial", 12))
result_label.pack(pady=20)

ticket_label = tk.Label(root, text=f"ğŸŸï¸ Tickets: {gacha_tickets}", font=("Arial", 12))
ticket_label.pack()

def spin_gacha():
    global gacha_tickets
    if gacha_tickets <= 0:
        result_label.config(text="ğŸš« No tickets left!")
    else:
        gacha_tickets -= 1
        reward = egg.open()
        inventory.append(reward)
        result_label.config(text=f"ğŸ‰ You got: {reward}")
        ticket_label.config(text=f"ğŸŸï¸ Tickets: {gacha_tickets}")

spin_button = tk.Button(root, text="ğŸ”„ Spin Gacha", font=("Arial", 14), command=spin_gacha)
spin_button.pack(pady=10)

def show_inventory():
    inventory_window = tk.Toplevel(root)
    inventory_window.title("ğŸ’ Inventory")
    inventory_window.geometry("300x200")
    if inventory:
        for i, item in enumerate(inventory, 1):
            tk.Label(inventory_window, text=f"{i}. {item}", font=("Arial", 11)).pack()
    else:
        tk.Label(inventory_window, text="ğŸ“­ Inventory is empty.", font=("Arial", 11)).pack()

inventory_button = tk.Button(root, text="ğŸ“¦ View Inventory", command=show_inventory)
inventory_button.pack(pady=10)

root.mainloop()
